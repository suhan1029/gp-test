<!-- templates/result.html -->
{% extends "base.html" %}

{% block content %}
<div class="content">
    <div class="horizontal-line"></div>
    <h1 class="header">Prediction Result</h1>
    <p class="subheader">Your personal color is:</p>
    <div class="prediction-container">
        <img src="{{ url_for('static', filename='images/' + prediction + '.jpg') }}" alt="{{ prediction }}" class="prediction-image">
        <div class="prediction-text {{ prediction }}-color">
            {{ prediction }}
        </div>
        <img src="{{ url_for('static', filename='images/' + prediction + '.jpg') }}" alt="{{ prediction }}" class="prediction-image">
    </div>
    <div class="explanation">
        <!-- Container for the streaming explanation -->
        <div id="explanation-text"></div>
    </div>
    <div class="button-container">
        <a href="/personal_color" class="upload-button no-underline">Classify another image</a>
    </div>
</div>

<!-- JavaScript for the typewriter effect -->
<script>
// Function to display HTML content with a typewriter effect
function typeWriterHTML(element, htmlContent, speed) {
    let index = 0;
    let isTag = false;
    let text = '';

    function type() {
        if (index < htmlContent.length) {
            let char = htmlContent[index];
            if (char === '<') {
                isTag = true;
            }
            if (isTag) {
                text += char;
            } else {
                text += char;
                element.innerHTML = text;
            }
            if (char === '>') {
                isTag = false;
                element.innerHTML = text;
            }
            index++;
            setTimeout(type, speed);
        }
    }
    type();
}

document.addEventListener('DOMContentLoaded', function() {
    const explanationHTML = `{{ explanation | safe | replace('\n', '\\n') | replace("'", "\\'") }}`;
    const explanationElement = document.getElementById('explanation-text');
    typeWriterHTML(explanationElement, explanationHTML, 30);
});
</script>
{% endblock %}
